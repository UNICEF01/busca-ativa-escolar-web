<div>
	<div class="panel panel-default">
		<div class="panel-heading clearfix">
			<div class="row">
				<div class="col-md-6">
					<h3><i class="fa fa-university"></i> Estados</h3>
				</div>
				<div class="col-md-6">
					<a ng-if="identity.can('ufs.manage')" ui-sref="pending_state_signups" class="btn btn-raised btn-primary pull-right"><i class="fa fa-question-circle"></i> Adesões estaduais</a>
				</div>
			</div>
		</div>
		<div class="panel-body">

			<table class="table table-striped table-hover">
				<thead>
					<tr>
						<th><column-sorter on-change="refresh" model="query.sort" field="'uf'">Nome</column-sorter></th>
						<th><column-sorter on-change="refresh" model="query.sort" field="'created_at'">Adesão</column-sorter></th>
						<th>Gestor estadual</th>
						<th>Demais usuários</th>
					</tr>
					<tr class="simple-filter">
						<th><input type="text" class="form-control" ng-model="query.filter.uf" ng-change="refresh()" placeholder="Filtrar por UF..." /></th>
						<th>
							<select class="form-control" ng-model="query.filter.created_at" ng-change="refresh()">
								<option value="">Todos</option>
								<option value="7">Últimos 7 dias</option>
								<option value="30">Últimos 30 dias</option>
								<option value="60">Últimos 60 dias</option>
								<option value="90">Últimos 90 dias</option>
							</select>
						</th>
						<th><input type="text" class="form-control" ng-model="query.filter.user_name" ng-change="refresh()" placeholder="Filtrar por nome..." /></th>
						<th></th>
					</tr>
				</thead>
				<tbody>
					<tr ng-repeat="(i, uf) in ufs.data">
						<td width="35%"><strong ng-bind="uf.name"></strong><br /></td>
						<td width="10%">
							<span class="label label-success" uib-tooltip-html="uf.created_at">{{uf.created_at | amCalendar}}</span>
						</td>
						<td width="5%">
							<div ng-show="uf.primary_user" class="{{uf.primary_user.deleted_at ? 'text-danger' : ''}}">
								<span ng-show="uf.primary_user">{{uf.primary_user.name}}</span> <i class="fa fa-ban" uib-tooltip="Usuário suspenso" ng-show="uf.primary_user.deleted_at"></i><br />
								<span class="label label-default"><i class="fa fa-envelope"></i> {{uf.primary_user.email}}</span>
							</div>

							<div class="label label-warning" ng-show="!uf.user">Gestor não cadastrado</div>
						</td>
						<td width="5%">
							<div ng-repeat="(i, user) in uf.users">
								<a ui-sref="user_editor({user_id: user.id})" class="btn btn-xs btn-default">
									<strong ng-class="{'text-danger': user.deleted_at}" >
										<span>{{user.name}}</span>
										<i ng-show="user.deleted_at" class="fa fa-ban" uib-tooltip="Usuário suspenso"></i>
									</strong><br />
									<span><i class="fa fa-envelope"></i> {{user.email}}</span>
								</a>
							</div>
						</td>
					</tr>
				</tbody>
			</table>

			<app-paginator collection="ufs" query="query" on-refresh="refresh"></app-paginator>

		</div>
	</div>
</div>